@model eKorpa.ViewModels.KorpaDetaljiVM

    <div id="main">

@if (Model != null)
{
    <div class="list-group">
        @foreach (var item in Model.rows)
        {
            <a href="#" class="list-group-item list-group-item-action flex align-items-start">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">Naziv artikla: @item.NazivArtikla</h5>
                    <small>Kategorija: @item.Kategorija</small>
                </div>
                <p class="mb-1">
                    @if (item.Slika.Count == 0)
                    {
                        <h1>Nema slike</h1>
                    }

                    @for (int i = 0; i < item.Slika.Count; i++)
                    {
                        @if (item.Slika[i] != null && item.Thumbnail[i] == 1)
                        {
                            var base64 = Convert.ToBase64String(item.Slika[i]);
                            var imgsrc = string.Format("data:image/gif;base64,{0}", base64);
                            <img src="@imgsrc" alt="Alternate Text" /><br />
                        }
                    }
                    Kolicina: @item.Kolicina
                    Cijena: @item.Cijena
                    <a href="/Korpa/Obrisi?KorpaID=@item.ID" class="list-group-item list-group-item-action flex-row-items-start">Obrisi</a>
                </p>
                </a>

        }
    </div>
}
    </div>

<div id="wrapper">
    <div class="dialog">
        <p id="dialogText">Jeste li sigurni da želite dovršiti kupovinu?</p>
        <a href="#" id="daBtn" onclick="Naruci()" class="btn btn-outline-success">DA</a>
        <a href="#" id="neBtn" onclick="Prekid()"  class="btn btn-outline-danger">NE</a>
    </div>
</div>


<a href="/Artikal/Index" class="btn btn-secondary">Artikli</a>
<button onclick="ShowDialog()" class="btn btn-secondary">Naruči</button>

<script>
    function ShowDialog() {
        document.getElementById("wrapper").style.display = "flex";
        document.getElementById("main").style.filter = "blur(8px)";
        BlurLayout();
    }

    function Naruci() {
        var url = "/Artikal/Kupi";

        $.get(url, function (odg) {
            console.log(odg);
            if (odg == "address404") {
                alert("Da bi završili kupovinu, morate imati validnu adresu.");
                Prekid();
            }
            else {
                alert("Kupovina uspješno dovršena.");
                window.location = "/Korpa/Detalji";
            }
        })
    }

    function Prekid() {
        document.getElementById("wrapper").style.display = "none";
        document.getElementById("main").style.filter = "none";
        DisableBlur();
    }
</script>

<style>
    body {
        background-color: rgb(45,45,45);
        color: lightcoral;
    }

        body a {
            color: lightblue;
        }

    img {
        width: 200px;
    }


    #wrapper {
        display: none;
        justify-content: center;
    }

    .dialog {
        background-color: lightgray;
        position: absolute;
        display: block;
        width: 300px;
        height: 150px;
        top: 35%;
    }

    #daBtn {
        position: relative;
        left: 70px;
        top: 50px;
    }

    #neBtn {
        position: relative;
        left: 125px;
        top: 50px;
    }

    #dialogText {
        position: relative;
        top: 15px;
    }
</style>
